<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KHELO TOPUP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Islamic Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <style>
        /* --- MAIN APP STYLES --- */
        body { font-family: 'Poppins', sans-serif; background-color: #f8fafc; transition: background-color 0.3s, color 0.3s; }
        
        /* Dark Mode Styles */
        body.dark-mode { background-color: #0f172a; color: #f1f5f9; }
        body.dark-mode .bg-white { background-color: #1e293b !important; color: #f1f5f9 !important; border-color: #334155 !important; }
        body.dark-mode .bg-slate-50 { background-color: #0f172a !important; }
        body.dark-mode .text-gray-800, body.dark-mode .text-gray-700, body.dark-mode .text-gray-600 { color: #e2e8f0 !important; }
        body.dark-mode .border-gray-100, body.dark-mode .border-gray-200 { border-color: #334155 !important; }
        body.dark-mode input { background-color: #334155 !important; color: white !important; border-color: #475569 !important; }
        body.dark-mode .nav-gradient { background: #1e293b; color: white; }
        body.dark-mode header { background-color: #1e293b !important; border-color: #334155 !important; }
        body.dark-mode nav { background-color: #1e293b !important; border-top-color: #334155 !important; }

        .nav-gradient { background: white; color: #1e293b; }
        .active-tab { color: #ec4899 !important; }
        .hidden { display: none !important; }
        
        /* Notice Scrolling Animation */
        .notice-scroll { animation: scroll-left 15s linear infinite; display: inline-block; white-space: nowrap; }
        @keyframes scroll-left { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        
        /* Method Card */
        .method-card { transition: all 0.2s; border: 2px solid transparent; }
        .method-card:active { transform: scale(0.95); }
        .method-card.selected-method { border-color: #ec4899; background-color: #fdf2f8; }
        body.dark-mode .method-card.selected-method { background-color: #334155; border-color: #ec4899; }

        /* Support Float */
        .support-float { animation: float 3s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }

        /* Animations */
        @keyframes fadeInUp { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .animate-fade-in { animation: fadeInUp 0.4s ease-out forwards; }

        /* --- PRODUCT CARD STYLE --- */
        .product-card {
            border: 1px solid #e2e8f0;
            background: white;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        body.dark-mode .product-card { background-color: #1e293b; border-color: #334155; }
        .product-card:hover { border-color: #f9a8d4; }
        .product-card.selected {
            border: 1.5px solid #ec4899; /* Pink Border */
            background-color: #fff; 
        }
        body.dark-mode .product-card.selected { background-color: #334155; }

        .product-bullet {
            height: 8px; width: 8px; background-color: #cbd5e1; border-radius: 50%; margin-right: 8px;
        }
        .product-card.selected .product-bullet { background-color: #ec4899; }
        
        /* Selection Cards for Add Money */
        .pay-select-card { transition: all 0.3s ease; }
        .pay-select-card:hover { transform: translateY(-3px); }
        .pay-select-card:active { transform: scale(0.98); }

        /* --- ISLAMIC HUB STYLES (GREEN THEME) --- */
        :root {
            --islamic-primary: #059669; /* Emerald 600 */
            --islamic-dark: #064e3b;    /* Emerald 900 */
            --islamic-accent: #f59e0b;  /* Amber */
        }
        .font-arabic {
            font-family: 'Amiri', serif;
        }
        .islamic-gradient {
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .prayer-card.completed {
            background-color: #fbbf24 !important;
            color: #064e3b !important; /* Dark Green Text */
            border-color: #fbbf24 !important;
            transform: scale(1.05);
        }
        #progress-container {
            cursor: pointer;
        }
        /* Custom Font override for Islamic Section */
        #islamic-sec { font-family: 'Hind Siliguri', sans-serif; }
        
        /* Islamic Bottom Nav Active State (Green) */
        .islamic-nav-btn.active { color: #059669; transform: translateY(-5px); }
        .islamic-nav-btn.active i { background-color: #ecfdf5; border-radius: 50%; padding: 10px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="select-none bg-slate-50">

<!-- AUTH SECTION -->
<section id="auth-sec" class="min-h-screen flex flex-col items-center justify-center p-6 bg-white z-50 fixed inset-0">
    <div class="w-full max-w-sm">
        <div class="text-center mb-8">
            <img id="auth-logo-img" src="https://i.postimg.cc/YCXZFzdR/file-00000000a04072069e266d3f98e37001-(1).png" class="h-20 mx-auto mb-3 object-contain">
            <p class="text-gray-500 text-sm">Best TopUp Service in BD</p>
        </div>

        <div class="flex bg-gray-100 p-1 rounded-lg mb-6">
            <button onclick="toggleAuth('login')" id="btn-login-view" class="w-1/2 py-2 rounded-md font-bold text-sm bg-white shadow text-pink-600 transition">Login</button>
            <button onclick="toggleAuth('register')" id="btn-reg-view" class="w-1/2 py-2 rounded-md font-bold text-sm text-gray-500 transition">Register</button>
        </div>

        <div id="login-form">
            <input type="email" id="login-email" placeholder="Email Address" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-3 text-gray-800">
            <input type="password" id="login-pass" placeholder="Password" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-4 text-gray-800">
            <button onclick="handleLogin()" class="w-full bg-pink-600 text-white py-3 rounded-lg font-bold shadow-lg hover:bg-pink-700 transition">LOG IN</button>
        </div>

        <div id="register-form" class="hidden">
            <input type="text" id="reg-name" placeholder="Full Name" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-3 text-gray-800">
            <input type="email" id="reg-email" placeholder="Email Address" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-3 text-gray-800">
            <input type="number" id="reg-phone" placeholder="Phone Number" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-3 text-gray-800">
            <input type="password" id="reg-pass" placeholder="Password (6+ chars)" class="w-full bg-gray-50 border border-gray-300 p-3 rounded-lg focus:outline-none focus:border-pink-500 mb-4 text-gray-800">
            <button onclick="handleRegister()" class="w-full bg-gray-800 text-white py-3 rounded-lg font-bold shadow-lg hover:bg-gray-900 transition">CREATE ACCOUNT</button>
        </div>
    </div>
</section>

<!-- APP CONTENT -->
<div id="app-content" class="hidden relative max-w-md mx-auto bg-slate-50 min-h-screen shadow-2xl pb-20">
    <!-- Header (Will be hidden in Islamic Mode) -->
    <header id="main-header" class="bg-white p-4 sticky top-0 z-40 flex justify-between items-center shadow-sm">
        <div class="flex items-center gap-2">
            <img id="header-logo-img" src="https://i.postimg.cc/YCXZFzdR/file-00000000a04072069e266d3f98e37001-(1).png" class="h-10 object-contain">
        </div>
        <div class="flex items-center gap-3">
            <button onclick="toggleDarkMode()" class="w-8 h-8 rounded-full bg-gray-100 dark:bg-slate-700 flex items-center justify-center text-gray-600 dark:text-yellow-400 transition">
                <i class="fas fa-moon" id="theme-icon"></i>
            </button>
            <div class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600 border border-gray-200">
                <i class="fas fa-wallet mr-1 text-pink-500"></i> ৳ <span id="header-balance">0</span>
            </div>
        </div>
    </header>

    <!-- Notice Section (Will be hidden in Islamic Mode) -->
    <div id="main-notice" class="bg-pink-600 text-white py-2 overflow-hidden shadow-inner flex items-center">
        <div class="px-3 bg-pink-800 h-full flex items-center z-10 font-bold text-xs uppercase tracking-wider">Notice</div>
        <div class="flex-1 overflow-hidden relative">
            <div id="notice-text" class="notice-scroll text-sm font-medium pl-4">Loading notice...</div>
        </div>
    </div>

    <!-- Main Container -->
    <main class="p-3 relative">
        
        <!-- HOME SECTION -->
        <section id="home-sec" class="animate-fade-in">
            <!-- Dynamic Slider -->
            <div id="banner-container" class="mb-6 rounded-xl overflow-hidden shadow-md h-44 bg-gray-200 relative group">
                <div id="slider-wrapper" class="flex h-full w-full transition-transform duration-500 ease-out">
                    <img src="https://placehold.co/600x300/e2136e/FFF?text=Loading..." class="w-full h-full object-cover flex-shrink-0">
                </div>
                <div id="slider-dots" class="absolute bottom-3 left-0 right-0 flex justify-center gap-2 z-10"></div>
            </div>

            <!-- CONTACT & APP GRID -->
            <div class="grid grid-cols-3 gap-3 mb-5 px-2">
                <a id="home-whatsapp" href="#" class="bg-white py-2 rounded-xl shadow-[0_2px_8px_rgba(0,0,0,0.05)] border border-gray-100 flex flex-col items-center justify-center gap-1.5 active:scale-95 transition h-24 no-underline">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center bg-green-50">
                        <i class="fab fa-whatsapp text-3xl text-[#25D366]"></i>
                    </div>
                    <span class="text-[11px] font-bold text-gray-700">WhatsApp</span>
                </a>
                <a id="home-telegram" href="#" class="bg-white py-2 rounded-xl shadow-[0_2px_8px_rgba(0,0,0,0.05)] border border-gray-100 flex flex-col items-center justify-center gap-1.5 active:scale-95 transition h-24 no-underline">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center bg-blue-50">
                        <i class="fab fa-telegram-plane text-3xl text-[#0088cc]"></i>
                    </div>
                    <span class="text-[11px] font-bold text-gray-700">Telegram</span>
                </a>
                
                <!-- ISLAMIC HUB BUTTON -->
                <div onclick="showSec('islamic')" class="cursor-pointer bg-white py-2 rounded-xl shadow-[0_2px_8px_rgba(0,0,0,0.05)] border border-gray-100 flex flex-col items-center justify-center gap-1.5 active:scale-95 transition h-24 no-underline">
                    <div class="w-10 h-10 rounded-full overflow-hidden shadow-sm flex items-center justify-center bg-emerald-50">
                       <i class="fas fa-kaaba text-2xl text-emerald-600"></i>
                    </div>
                    <span class="text-[11px] font-bold text-gray-700 text-center leading-tight">Islamic<br>Hub</span>
                </div>
            </div>

            <div class="flex items-center justify-between mb-3 px-1">
                <h3 class="font-bold text-gray-700 text-lg border-l-4 border-pink-500 pl-2">All Products</h3>
            </div>
            
            <div id="services-list" class="grid grid-cols-3 gap-3 px-1 mb-8">
                <div class="col-span-3 text-center py-10"><i class="fas fa-spinner fa-spin text-pink-500"></i> Loading Games...</div>
            </div>

            <div class="mt-8 mb-6">
                <h3 class="text-center font-bold text-slate-700 text-xl mb-5 font-serif">Latest 5 Orders</h3>
                <div id="latest-orders-list" class="space-y-3 px-1">
                    <!-- Orders will load here -->
                </div>
            </div>

            <!-- FOOTER SECTION -->
            <div class="mt-10 -mx-3 bg-[#880E4F] text-white pt-8 px-5 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.2)] pb-20">  
                <div class="mb-6">
                    <h3 class="font-serif text-xl font-medium tracking-wide mb-3">STAY CONNECTED</h3>
                    <p class="text-xs text-pink-100 font-light leading-relaxed mb-4 opacity-90">
                        কোন সমস্যায় পড়লে হোয়াটসঅ্যাপ এ যোগাযোগ করবেন। তাহলে দ্রুত সমাধান পেয়ে যাবেন।
                    </p>
                    <div class="flex gap-4">
                        <a id="ft-fb" href="#" class="w-10 h-10 border border-pink-300/30 rounded-lg flex items-center justify-center hover:bg-white hover:text-[#880E4F] transition"><i class="fab fa-facebook-f"></i></a>
                        <a id="ft-insta" href="#" class="w-10 h-10 border border-pink-300/30 rounded-lg flex items-center justify-center hover:bg-white hover:text-[#880E4F] transition"><i class="fab fa-instagram"></i></a>
                        <a id="ft-yt" href="#" class="w-10 h-10 border border-pink-300/30 rounded-lg flex items-center justify-center hover:bg-white hover:text-[#880E4F] transition"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="w-10 h-10 border border-pink-300/30 rounded-lg flex items-center justify-center hover:bg-white hover:text-[#880E4F] transition"><i class="far fa-envelope"></i></a>
                    </div>
                </div>

                <div class="mb-6">
                    <h3 class="font-serif text-xl font-medium tracking-wide mb-3">OUR MOBILE APP</h3>
                    <a id="ft-app-link" href="#" target="_blank" class="inline-block border border-white/40 rounded-lg overflow-hidden w-36 hover:opacity-80 transition">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg" alt="Get it on Google Play" class="w-full h-auto">
                    </a>
                </div>

                <div class="mb-8">
                    <h3 class="font-serif text-xl font-medium tracking-wide mb-3">SUPPORT CENTER</h3>
                    <a id="ft-whatsapp" href="#" class="block mb-3 group">
                        <div class="border border-pink-300/30 rounded-lg p-2.5 flex items-center gap-3 group-hover:bg-white/10 transition">
                            <div class="w-10 h-10 flex items-center justify-center"><i class="fab fa-whatsapp text-3xl"></i></div>
                            <div class="border-l border-pink-300/30 pl-3 h-full flex flex-col justify-center">
                                <span class="text-[9px] text-pink-200 uppercase tracking-wider">Help line [9AM - 10PM]</span>
                                <span id="ft-wa-num" class="font-bold text-lg font-mono leading-none mt-0.5">+8801xxxxxxxxx</span>
                            </div>
                        </div>
                    </a>
                    <a id="ft-telegram" href="#" class="block group">
                        <div class="border border-pink-300/30 rounded-lg p-2.5 flex items-center gap-3 group-hover:bg-white/10 transition">
                            <div class="w-10 h-10 flex items-center justify-center"><i class="fab fa-telegram-plane text-3xl"></i></div>
                            <div class="border-l border-pink-300/30 pl-3 h-full flex flex-col justify-center">
                                <span class="text-[9px] text-pink-200 uppercase tracking-wider">Help line [9AM - 10PM]</span>
                                <span class="font-bold text-lg leading-none mt-0.5">Telegram Support</span>
                            </div>
                        </div>
                    </a>
                </div>

                <div class="text-center border-t border-pink-900/50 pt-4">
                    <p class="text-[10px] text-pink-200 opacity-70 mb-1">
                        © Copyright 2026 <span id="footer-site-name" class="font-bold">KHELO TOPUP</span>. All Rights Reserved.
                    </p>
                    <p class="text-xs font-medium text-pink-100 mb-0">
                        Developed by <a href="#" class="text-yellow-400 font-bold hover:underline">KHELO BUZZ</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- TOPUP INTERFACE SECTION -->
        <section id="topup-sec" class="hidden animate-fade-in pb-10">
            <div class="flex items-center gap-3 mb-4 p-1">
                <button onclick="showSec('home')" class="text-gray-600 hover:text-pink-500 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200">
                    <i class="fas fa-arrow-left text-lg"></i>
                </button>
                <h2 class="text-lg font-bold text-gray-800" id="topup-game-title">Game Name</h2>
            </div>

            <div class="bg-white p-3 rounded-xl shadow-sm flex items-center gap-4 mb-4 border border-gray-100">
                <img id="topup-game-img" src="" class="w-16 h-16 rounded-xl object-cover shadow-sm">
                <div>
                    <h3 class="font-bold text-gray-800 text-base" id="topup-sub-title">FF UID TOPUP (BD)</h3>
                    <p class="text-xs text-gray-400 font-medium">Game / Topup</p>
                </div>
            </div>

            <div class="bg-white p-4 rounded-xl shadow-sm mb-4 border border-gray-100">
                <div class="flex items-center gap-2 mb-3">
                    <span class="bg-pink-600 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold shadow-md">1</span>
                    <h3 class="font-bold text-gray-700 text-sm">Player Id</h3>
                </div>
                <input type="text" id="game-player-id" placeholder="2535040417" class="w-full bg-gray-50 border border-gray-200 p-3 rounded-lg focus:outline-none focus:border-pink-500 focus:bg-white transition font-bold text-gray-700 tracking-wider text-lg">
                
                <div class="mt-3 bg-gradient-to-r from-blue-400 to-teal-400 text-white text-center py-2 rounded-lg font-bold text-sm shadow-md">
                    YOUR FREE FIRE UID
                </div>

                <div class="mt-5 border-t border-gray-100 pt-4">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-gray-600">Total Payable</span>
                        <span class="text-xl font-bold text-pink-600">৳ <span id="total-price">0</span></span>
                    </div>
                    <button onclick="processOrder()" class="w-full bg-pink-600 text-white py-3 rounded-lg font-bold shadow-lg hover:bg-pink-700 transition flex justify-center items-center gap-2 active:scale-95">
                         BUY NOW
                    </button>
                </div>
            </div>

            <div class="bg-white p-4 rounded-xl shadow-sm mb-4 border border-gray-100">
                <div class="flex items-center gap-2 mb-4">
                    <span class="bg-pink-600 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold shadow-md">2</span>
                    <h3 class="font-bold text-gray-700 text-sm">Select Recharge</h3>
                </div>
                <div id="product-loader" class="text-center py-10 hidden">
                    <i class="fas fa-spinner fa-spin text-pink-500 text-2xl"></i>
                </div>
                <div id="products-grid" class="grid grid-cols-2 gap-3"></div>
            </div>

            <div id="game-rules-box" class="bg-yellow-50 border border-yellow-200 p-4 rounded-xl shadow-sm mb-6 hidden">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fas fa-exclamation-triangle text-yellow-600"></i>
                    <h3 class="font-bold text-yellow-700 text-sm">Important Rules</h3>
                </div>
                <p id="game-rules-text" class="text-xs text-yellow-800 leading-relaxed font-medium"></p>
            </div>
        </section>

        <!-- ADD MONEY SECTION -->
        <section id="addmoney-sec" class="hidden animate-fade-in pb-10">
            <h2 class="font-bold text-xl text-gray-800 mb-4 px-2">Add Money</h2>
            <div id="pay-mode-selection" class="grid grid-cols-1 gap-4 mb-6">
                <!-- Auto Pay Card -->
                <div id="card-auto-pay" onclick="toggleAddMoneyMode('auto')" class="hidden pay-select-card bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-5 text-white shadow-lg cursor-pointer relative overflow-hidden group">
                    <div class="absolute right-0 top-0 opacity-10 transform translate-x-4 -translate-y-4">
                        <i class="fas fa-bolt text-9xl"></i>
                    </div>
                    <div class="flex items-center gap-4 relative z-10">
                        <div class="w-14 h-14 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center shadow-inner">
                            <i class="fas fa-robot text-2xl text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold italic">AUTO PAY</h3>
                            <p class="text-xs text-pink-100 font-medium">Instant Balance Add (24/7)</p>
                        </div>
                    </div>
                </div>
                <!-- Manual Pay Card -->
                <div onclick="toggleAddMoneyMode('manual')" class="pay-select-card bg-white rounded-2xl p-5 border border-gray-200 shadow-md cursor-pointer flex items-center gap-4 group hover:border-blue-500 transition-colors">
                    <div class="w-14 h-14 bg-blue-50 rounded-full flex items-center justify-center text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fas fa-hand-holding-usd text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 group-hover:text-blue-600 transition-colors">MANUAL PAY</h3>
                        <p class="text-xs text-gray-400">Wait for admin approval</p>
                    </div>
                </div>
            </div>
            
            <button id="btn-back-selection" onclick="resetAddMoney()" class="hidden mb-4 text-gray-500 font-bold text-sm flex items-center gap-2 hover:text-pink-600">
                <i class="fas fa-arrow-left"></i> Back to Methods
            </button>

            <!-- AUTO PAY FORM -->
            <div id="auto-pay-form" class="hidden animate-fade-in">
                 <div class="bg-white p-5 rounded-2xl shadow-lg border border-pink-100 mb-6">
                    <div class="text-center mb-4">
                        <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider">Instant Add</span>
                        <h3 class="font-bold text-gray-800 mt-2">Select Payment Method</h3>
                    </div>
                    <div class="grid grid-cols-3 gap-3 mb-5">
                        <div onclick="selectAutoMethod('bKash')" class="method-card bg-gray-50 p-2 rounded-xl flex flex-col items-center cursor-pointer" id="auto-card-bKash">
                            <img src="https://i.ibb.co.com/9kCCTNsx/1656227518bkash-logo-png.png" class="w-10 h-10 object-contain mb-1">
                            <span class="text-[10px] font-bold text-gray-700">bKash</span>
                        </div>
                        <div onclick="selectAutoMethod('Nagad')" class="method-card bg-gray-50 p-2 rounded-xl flex flex-col items-center cursor-pointer" id="auto-card-Nagad">
                            <img src="https://i.ibb.co.com/VcqJTvpn/Nagad-Logo-horizontally-og.png" class="w-12 h-10 object-contain mb-1">
                            <span class="text-[10px] font-bold text-gray-700">Nagad</span>
                        </div>
                        <div onclick="selectAutoMethod('Rocket')" class="method-card bg-gray-50 p-2 rounded-xl flex flex-col items-center cursor-pointer" id="auto-card-Rocket">
                            <img src="https://i.ibb.co.com/wFZkNM48/rocket-color-logo-mobile-banking-icon-free-png.png" class="w-8 h-10 object-contain mb-1">
                            <span class="text-[10px] font-bold text-gray-700">Rocket</span>
                        </div>
                    </div>
                    <div id="auto-pay-details" class="hidden">
                        <div class="bg-blue-50 p-3 rounded-lg border border-blue-100 mb-4 text-center">
                            <p class="text-[10px] text-gray-500">Send Money to (Personal)</p>
                            <div class="flex justify-center items-center gap-2 mt-1">
                                <span id="auto-pay-number" class="font-mono font-bold text-lg text-gray-800 tracking-wider">Loading...</span>
                                <i onclick="copyAutoNumber()" class="far fa-copy text-pink-600 cursor-pointer"></i>
                            </div>
                        </div>
                        <label class="text-xs font-bold text-gray-500 ml-1">Transaction ID</label>
                        <input type="text" id="auto-trx-id" placeholder="Enter TrxID (e.g. 9G7H...)" class="w-full bg-gray-50 border border-gray-200 p-3 rounded-lg font-bold uppercase focus:outline-none focus:border-pink-500 mb-4 mt-1 text-gray-800">
                        <button onclick="handleAutoPayVerify()" class="w-full bg-green-600 text-white py-3 rounded-lg font-bold shadow-lg hover:bg-green-700 transition">VERIFY & ADD MONEY</button>
                    </div>
                 </div>
            </div>

            <!-- MANUAL PAY FORM -->
            <div id="manual-pay-form" class="hidden animate-fade-in">
                <div id="payment-methods-grid" class="grid grid-cols-3 gap-3 mb-6">
                    <div onclick="showPaymentForm('bKash', 'https://i.ibb.co.com/9kCCTNsx/1656227518bkash-logo-png.png', '#e2136e')" class="bg-white p-3 rounded-xl shadow-sm flex flex-col items-center justify-center cursor-pointer method-card h-28">
                        <img src="https://i.ibb.co.com/9kCCTNsx/1656227518bkash-logo-png.png" class="w-12 h-12 object-contain mb-2">
                        <span class="text-xs font-bold text-gray-600">bKash</span>
                    </div>
                    <div onclick="showPaymentForm('Nagad', 'https://i.ibb.co.com/VcqJTvpn/Nagad-Logo-horizontally-og.png', '#f7941d')" class="bg-white p-3 rounded-xl shadow-sm flex flex-col items-center justify-center cursor-pointer method-card h-28">
                        <img src="https://i.ibb.co.com/VcqJTvpn/Nagad-Logo-horizontally-og.png" class="w-16 h-12 object-contain mb-2">
                        <span class="text-xs font-bold text-gray-600">Nagad</span>
                    </div>
                    <div onclick="showPaymentForm('Rocket', 'https://i.ibb.co.com/wFZkNM48/rocket-color-logo-mobile-banking-icon-free-png.png', '#8c3494')" class="bg-white p-3 rounded-xl shadow-sm flex flex-col items-center justify-center cursor-pointer method-card h-28">
                        <img src="https://i.ibb.co.com/wFZkNM48/rocket-color-logo-mobile-banking-icon-free-png.png" class="w-10 h-12 object-contain mb-2">
                        <span class="text-xs font-bold text-gray-600">Rocket</span>
                    </div>
                </div>
                <div id="payment-form-container" class="hidden bg-white p-5 rounded-2xl shadow-lg border border-gray-100">
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center gap-2">
                            <img id="form-logo" src="" class="w-8 h-8 object-contain">
                            <h3 id="form-method-name" class="font-bold text-lg text-gray-800">Method</h3>
                        </div>
                        <button onclick="resetManualForm()" class="text-gray-400 hover:text-red-500"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 mb-4 flex justify-between items-center">
                        <div>
                            <p class="text-[10px] text-gray-500">Send Money (Personal)</p>
                            <p id="admin-number" class="font-mono font-bold text-lg tracking-wider text-gray-700">Loading...</p>
                        </div>
                        <button onclick="copyNumber()" class="bg-white p-2 rounded shadow-sm text-pink-600"><i class="far fa-copy"></i></button>
                    </div>
                    <div class="space-y-4">
                        <input type="number" id="dep-amount" placeholder="Amount" class="w-full bg-gray-50 border border-gray-200 p-3 rounded-lg font-bold focus:outline-none focus:border-pink-500 text-gray-800">
                        <input type="text" id="dep-trx" placeholder="Transaction ID" class="w-full bg-gray-50 border border-gray-200 p-3 rounded-lg font-bold uppercase focus:outline-none focus:border-pink-500 text-gray-800">
                        <button onclick="submitDeposit()" class="w-full bg-pink-600 text-white py-3 rounded-lg font-bold shadow-lg hover:bg-pink-700 transition">Request Verification</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ACCOUNT SECTION -->
        <section id="account-sec" class="hidden animate-fade-in">
            <div class="bg-white p-6 rounded-xl shadow-sm mb-4 text-center border border-gray-100">
                <div class="w-20 h-20 bg-pink-50 rounded-full mx-auto flex items-center justify-center text-pink-500 text-3xl mb-3 shadow-inner">
                    <i class="fas fa-user-circle text-5xl"></i>
                </div>
                <h2 id="profile-name" class="font-bold text-xl text-gray-800">User Name</h2>
                <p id="profile-email" class="text-xs text-gray-500 mb-6 font-mono">user@email.com</p>

                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-pink-50 p-3 rounded-2xl border border-pink-100 flex flex-col items-center justify-center">
                        <div class="w-8 h-8 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 mb-1">
                            <i class="fas fa-wallet text-sm"></i>
                        </div>
                        <p class="text-[10px] text-gray-500 font-bold uppercase tracking-wider">Balance</p>
                        <p class="text-sm font-extrabold text-pink-600">৳ <span id="profile-balance">0</span></p>
                    </div>
                    <div class="bg-blue-50 p-3 rounded-2xl border border-blue-100 flex flex-col items-center justify-center">
                        <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 mb-1">
                            <i class="fas fa-shopping-bag text-sm"></i>
                        </div>
                        <p class="text-[10px] text-gray-500 font-bold uppercase tracking-wider">Orders</p>
                        <p class="text-sm font-extrabold text-blue-600" id="profile-total-orders">0</p>
                    </div>
                    <div class="bg-purple-50 p-3 rounded-2xl border border-purple-100 flex flex-col items-center justify-center">
                        <div class="w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 mb-1">
                            <i class="fas fa-coins text-sm"></i>
                        </div>
                        <p class="text-[10px] text-gray-500 font-bold uppercase tracking-wider">Spent</p>
                        <p class="text-sm font-extrabold text-purple-600">৳ <span id="profile-total-spent">0</span></p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100">
                <button onclick="showSec('history')" class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center text-blue-500"><i class="fas fa-history"></i></div>
                        <span class="text-sm font-semibold text-gray-700">Order History</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-300 text-xs"></i>
                </button>
                <button onclick="showSec('deposit-history')" class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-purple-50 flex items-center justify-center text-purple-500"><i class="fas fa-file-invoice-dollar"></i></div>
                        <span class="text-sm font-semibold text-gray-700">Add Money History</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-300 text-xs"></i>
                </button>
                <button onclick="showSec('addmoney')" class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-green-50 flex items-center justify-center text-green-500"><i class="fas fa-plus-circle"></i></div>
                        <span class="text-sm font-semibold text-gray-700">Add Money</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-300 text-xs"></i>
                </button>
                <button onclick="handleLogout()" class="w-full flex items-center justify-between p-4 hover:bg-red-50 text-red-500 transition group">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center group-hover:bg-red-200 transition"><i class="fas fa-sign-out-alt"></i></div>
                        <span class="text-sm font-bold">Log Out</span>
                    </div>
                </button>
            </div>
        </section>

        <!-- ORDER HISTORY SECTION -->
        <section id="history-sec" class="hidden animate-fade-in pb-24">
            <div class="px-4 pt-4 mb-2">
                <h2 class="text-xl font-bold text-gray-800 border-l-4 border-pink-500 pl-2">Order History</h2>
            </div>
            <div id="history-list" class="px-4"></div>
        </section>

        <!-- ADD MONEY HISTORY SECTION -->
        <section id="deposit-history-sec" class="hidden animate-fade-in pb-24">
            <div class="px-4 pt-4 mb-2">
                <h2 class="text-xl font-bold text-gray-800 border-l-4 border-purple-500 pl-2">Deposit History</h2>
            </div>
            <div id="deposit-history-list" class="px-4 space-y-3"></div>
        </section>

        <!-- ISLAMIC HUB SECTION (GREEN THEME & FIXED NAV) -->
        <!-- Fix: Flex column layout for sticky header/nav support -->
        <section id="islamic-sec" class="hidden animate-fade-in fixed inset-0 z-[100] bg-slate-50 flex flex-col">
            <!-- Loading Screen (Internal for this tab) -->
            <div id="islamic-loading" class="hidden inset-0 z-[110] bg-white flex-col items-center justify-center absolute h-full fixed">
                <div class="w-16 h-16 border-4 border-emerald-100 border-t-emerald-700 rounded-full animate-spin"></div>
                <p class="mt-4 font-bold text-emerald-900">ইসলামিক হাব লোড হচ্ছে...</p>
            </div>

            <!-- Islamic Header (Sticky Top) -->
            <header class="flex-none bg-white/95 backdrop-blur-md px-6 py-4 flex justify-between items-center border-b border-emerald-100 shadow-sm z-50">
                <div class="flex items-center gap-3">
                    <button onclick="showSec('home')" class="w-8 h-8 rounded-full bg-emerald-50 text-emerald-600 flex items-center justify-center hover:bg-emerald-100 transition">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <div>
                        <h1 class="font-black text-emerald-950 text-xl leading-none">ইসলামিক হাব</h1>
                        <span class="text-[10px] font-bold text-amber-600 tracking-widest uppercase">KHELO TOPUP</span>
                    </div>
                </div>
                <div id="current-location" class="text-[10px] bg-emerald-50 px-3 py-1 rounded-full text-emerald-600 font-bold border border-emerald-100">ঢাকা, বাংলাদেশ</div>
            </header>

            <!-- Scrollable Content Area -->
            <div class="flex-1 overflow-y-auto pb-32 relative px-5 pt-4">
                
                <!-- Tab: Home -->
                <div id="islam-home" class="tab-content active space-y-6">
                    <!-- Hero Hijri Card (Green Gradient) -->
                    <div class="islamic-gradient rounded-[2.5rem] p-6 text-white shadow-xl relative overflow-hidden">
                        <div class="relative z-10">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-amber-300 font-bold text-sm">আসসালামু আলাইকুম</p>
                                    <h2 class="text-2xl font-black mt-1">পরবর্তী সালাত</h2>
                                    <p id="next-prayer-info" class="text-emerald-100 font-black text-lg mt-1 tracking-tight">লোড হচ্ছে...</p>
                                </div>
                                <div class="glass p-2 rounded-2xl text-center min-w-[80px]">
                                    <span id="hijri-month" class="text-[10px] font-black block uppercase tracking-tighter">লোড হচ্ছে...</span>
                                    <span id="hijri-day" class="text-lg font-black leading-none">--</span>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 mt-8">
                                <div class="glass rounded-3xl p-4">
                                    <p class="text-[10px] text-emerald-100 font-bold uppercase mb-1">সেহরি শেষ</p>
                                    <p id="time-imsak" class="text-xl font-black text-amber-300">--:-- --</p>
                                </div>
                                <div class="glass rounded-3xl p-4">
                                    <p class="text-[10px] text-emerald-100 font-bold uppercase mb-1">ইফতারের সময়</p>
                                    <p id="time-maghrib" class="text-xl font-black text-amber-300">--:-- --</p>
                                </div>
                            </div>
                        </div>
                        <div class="absolute -bottom-10 -left-10 w-40 h-40 bg-white/5 rounded-full blur-3xl"></div>
                    </div>

                    <!-- Prayer Grid -->
                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-black text-emerald-900 text-lg">নামাজের সময়সূচী</h3>
                            <span id="hijri-year-bn" class="text-[10px] font-bold text-slate-400 bg-emerald-50 px-2 py-0.5 rounded-full uppercase">---</span>
                        </div>
                        <div class="grid grid-cols-3 gap-3" id="prayer-times-grid"></div>
                    </div>

                    <!-- Premium Tracker (Green) - FIXED CLICK ISSUE -->
                    <div class="bg-emerald-950 rounded-[2.5rem] p-6 text-white shadow-2xl relative overflow-hidden border border-emerald-800">
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <h4 class="font-black text-amber-400">সালাত ট্র্যাকার</h4>
                                <p class="text-[10px] text-emerald-200 uppercase font-bold tracking-widest">ব্যক্তিগত ইবাদত ডায়েরি</p>
                            </div>
                            <span id="tracker-percent" class="text-3xl font-black text-white">0%</span>
                        </div>
                        <div class="h-3 bg-emerald-900 rounded-full overflow-hidden mb-6">
                            <div id="tracker-progress-bar" class="h-full bg-gradient-to-r from-amber-600 to-amber-300 transition-all duration-700 w-0"></div>
                        </div>
                        <div class="grid grid-cols-5 gap-2" id="tracker-buttons"></div>
                    </div>
                </div>

                <!-- Tab: Quran -->
                <div id="islam-quran" class="tab-content space-y-6">
                    <div class="mb-4">
                        <h2 class="text-2xl font-black text-emerald-950 leading-tight">আল-কুরআন</h2>
                        <p class="text-xs text-slate-400 font-bold uppercase tracking-wider">তেলাওয়াত ও বঙ্গানুবাদ</p>
                    </div>
                    <div id="surah-list" class="space-y-3"></div>
                </div>

                <!-- Tab: Dua -->
                <div id="islam-dua" class="tab-content space-y-6">
                    <div class="mb-4">
                        <h2 class="text-2xl font-black text-emerald-950 leading-tight">দোয়া ও জিকির</h2>
                        <p class="text-xs text-slate-400 font-bold uppercase tracking-wider">মাসনুন দোয়া সমূহ</p>
                    </div>
                    <div id="dua-list" class="space-y-6"></div>
                </div>

                <!-- Tab: Names (Updated with 99 Names) -->
                <div id="islam-names" class="tab-content space-y-6">
                    <div class="mb-4">
                        <h2 class="text-2xl font-black text-emerald-950 leading-tight">আল্লাহর ৯৯ নাম</h2>
                        <p class="text-xs text-slate-400 font-bold uppercase tracking-wider">অর্থ ও ফজিলত</p>
                    </div>
                    <div id="names-grid" class="grid grid-cols-2 gap-4"></div>
                </div>
            </div>
            
            <audio id="global-audio"></audio>
            
            <!-- Global Quran Player Widget (Green) -->
            <div id="quran-player-bar" class="fixed bottom-28 left-4 right-4 bg-emerald-900 text-white p-3 rounded-2xl shadow-2xl z-[60] hidden animate-in slide-in-from-bottom duration-300">
                <div class="flex items-center gap-3">
                    <div id="player-disk" class="w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center animate-spin-slow">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <p id="playing-surah-name" class="font-bold text-xs truncate">সূরা প্লে হচ্ছে</p>
                        <div id="progress-container" onclick="seekAudio(event)" class="h-4 flex items-center w-full cursor-pointer group">
                            <div class="h-1 bg-white/20 rounded-full w-full overflow-hidden group-hover:h-2 transition-all">
                                <div id="player-progress" class="h-full bg-amber-400 w-0 pointer-events-none"></div>
                            </div>
                        </div>
                    </div>
                    <button onclick="toggleAudio()" class="w-8 h-8 flex items-center justify-center bg-white/10 rounded-full">
                        <span id="play-pause-icon">⏸</span>
                    </button>
                    <button onclick="closeAudio()" class="text-white/40">✕</button>
                </div>
            </div>

            <!-- ISLAMIC BOTTOM NAVIGATION (Fixed at bottom) -->
            <nav class="flex-none bg-white border-t border-emerald-100 py-3 px-6 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-50 rounded-t-3xl relative">
                <div class="flex justify-between items-center">
                    <button onclick="switchTab('home')" class="islamic-nav-btn active flex flex-col items-center text-gray-400 transition-all duration-300" data-tab="home">
                        <i class="fas fa-home text-xl mb-1"></i><span class="text-xs font-bold">হোম</span>
                    </button>
                    <button onclick="switchTab('quran')" class="islamic-nav-btn flex flex-col items-center text-gray-400 transition-all duration-300" data-tab="quran">
                        <i class="fas fa-quran text-xl mb-1"></i><span class="text-xs font-bold">কুরআন</span>
                    </button>
                    <button onclick="switchTab('dua')" class="islamic-nav-btn flex flex-col items-center text-gray-400 transition-all duration-300" data-tab="dua">
                        <i class="fas fa-hands-praying text-xl mb-1"></i><span class="text-xs font-bold">দোয়া</span>
                    </button>
                    <button onclick="switchTab('names')" class="islamic-nav-btn flex flex-col items-center text-gray-400 transition-all duration-300" data-tab="names">
                        <i class="fas fa-star-and-crescent text-xl mb-1"></i><span class="text-xs font-bold">নামসমূহ</span>
                    </button>
                </div>
            </nav>
        </section>

    </main>

    <!-- FLOATING HELP -->
    <div class="fixed bottom-20 right-4 z-40 support-float">
        <img onclick="toggleSupportModal()" src="https://i.ibb.co.com/RG5qbS8t/20260120-195807.png" class="w-[150px] h-auto cursor-pointer filter drop-shadow-xl hover:scale-105 transition-transform duration-200">
    </div>

    <div id="support-modal" class="hidden fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-60 backdrop-blur-sm">
        <div class="bg-white p-6 rounded-2xl shadow-2xl w-72 relative animate-popup">
            <button onclick="toggleSupportModal()" class="absolute top-2 right-3 text-gray-400 hover:text-red-500 text-xl"><i class="fas fa-times"></i></button>
            <h3 class="font-bold text-center text-gray-800 text-lg mb-4">Contact Us</h3>
            <div class="flex flex-col gap-3">
                <a id="link-telegram" href="#" target="_blank" class="flex items-center justify-center gap-3 bg-[#0088cc] text-white py-3 rounded-xl shadow-md">
                    <i class="fab fa-telegram-plane text-2xl"></i> <span class="font-bold">Telegram</span>
                </a>
                <a id="link-whatsapp" href="#" target="_blank" class="flex items-center justify-center gap-3 bg-[#25D366] text-white py-3 rounded-xl shadow-md">
                    <i class="fab fa-whatsapp text-2xl"></i> <span class="font-bold">WhatsApp</span>
                </a>
            </div>
        </div>
    </div>

    <!-- MAIN APP Bottom Navigation (Hidden when Islamic Hub is active) -->
    <nav id="main-nav" class="fixed bottom-0 w-full bg-white border-t border-gray-100 py-2 px-6 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-40 max-w-md mx-auto left-0 right-0">
        <div class="flex justify-between items-center">
            <button onclick="showSec('home')" class="nav-item flex flex-col items-center text-gray-400 active-tab" id="nav-home">
                <i class="fas fa-home text-xl"></i><span class="text-[10px] mt-1 font-medium">Home</span>
            </button>
            <!-- ISLAMIC TAB ADDED HERE -->
            <button onclick="showSec('islamic')" class="nav-item flex flex-col items-center text-gray-400" id="nav-islamic">
                <i class="fas fa-mosque text-xl"></i><span class="text-[10px] mt-1 font-medium">Islam</span>
            </button>
            <button onclick="showSec('addmoney')" class="add-money-btn bg-pink-600 -mt-8 h-14 w-14 rounded-full flex items-center justify-center text-white border-4 border-gray-50 transform active:scale-90 transition shadow-lg">
                <i class="fas fa-plus text-2xl"></i>
            </button>
            <button onclick="showSec('history')" class="nav-item flex flex-col items-center text-gray-400" id="nav-history">
                <i class="fas fa-history text-xl"></i><span class="text-[10px] mt-1 font-medium">History</span>
            </button>
            <button onclick="showSec('account')" class="nav-item flex flex-col items-center text-gray-400" id="nav-account">
                <i class="fas fa-user text-xl"></i><span class="text-[10px] mt-1 font-medium">Account</span>
            </button>
        </div>
    </nav>
</div>

<script>
    // --- 1. FIREBASE CONFIGURATION ---
    const firebaseConfig = {
      apiKey: "AIzaSyD8Rnh08XGw9HdYi0BYGCVBKd0ENBQl0CU",
      authDomain: "fh-top-up-2.firebaseapp.com",
      projectId: "fh-top-up-2",
      storageBucket: "fh-top-up-2.firebasestorage.app",
      messagingSenderId: "214767016319",
      appId: "1:214767016319:web:5f017307d5be94386d624a",
      measurementId: "G-VYS9QHSSK6",
      databaseURL: "https://fh-top-up-2-default-rtdb.firebaseio.com" // Important for Realtime DB
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const rdb = firebase.database(); 

    let currentUser = null;
    let userBalance = 0;
    let selectedProduct = null;
    let selectedGameId = null;
    let selectedGameName = "";
    let gamesData = {};
    let isAutoPayEnabled = false; 
    let globalPaymentNumbers = { bkash: "", nagad: "", rocket: "" };

    // --- DARK MODE LOGIC ---
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        const icon = document.getElementById('theme-icon');
        const isDark = document.body.classList.contains('dark-mode');
        icon.className = isDark ? "fas fa-sun" : "fas fa-moon";
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }
    if(localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
        document.getElementById('theme-icon').className = "fas fa-sun";
    }

    function loadGlobalSettings() {
        db.collection("settings").doc("global").onSnapshot((doc) => {
            if (doc.exists) {
                const data = doc.data();
                const logoUrl = data.logoUrl || "https://i.postimg.cc/YCXZFzdR/file-00000000a04072069e266d3f98e37001-(1).png";
                const siteName = data.siteName || "KHELO TOPUP";

                const authLogo = document.getElementById('auth-logo-img');
                if(authLogo) authLogo.src = logoUrl;
                const headerLogo = document.getElementById('header-logo-img');
                if(headerLogo) headerLogo.src = logoUrl;
                const footerName = document.getElementById('footer-site-name');
                if(footerName) footerName.innerText = siteName;
                document.title = siteName;
                isAutoPayEnabled = data.autoPayEnabled === true;
                if(data.payment_numbers) globalPaymentNumbers = data.payment_numbers;
                const autoCard = document.getElementById('card-auto-pay');
                if(autoCard) {
                    if (isAutoPayEnabled) autoCard.classList.remove('hidden');
                    else autoCard.classList.add('hidden');
                }
            }
        });
    }
    loadGlobalSettings();

    // --- 2. AUTH LOGIC ---
    function toggleAuth(view) {
        if(view === 'login') {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('register-form').classList.add('hidden');
            document.getElementById('btn-login-view').classList.add('bg-white', 'shadow', 'text-pink-600');
            document.getElementById('btn-reg-view').classList.remove('bg-white', 'shadow', 'text-pink-600');
        } else {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.remove('hidden');
            document.getElementById('btn-reg-view').classList.add('bg-white', 'shadow', 'text-pink-600');
            document.getElementById('btn-login-view').classList.remove('bg-white', 'shadow', 'text-pink-600');
        }
    }
    function handleRegister() {
        const name = document.getElementById('reg-name').value;
        const email = document.getElementById('reg-email').value;
        const pass = document.getElementById('reg-pass').value;
        const phone = document.getElementById('reg-phone').value;
        if(!name || !email || !pass) return Swal.fire('Error', 'Please fill all fields', 'error');
        Swal.showLoading();
        auth.createUserWithEmailAndPassword(email, pass)
            .then((cred) => db.collection('users').doc(cred.user.uid).set({
                name: name, email: email, phone: phone, balance: 0, createdAt: new Date()
            }))
            .then(() => Swal.fire('Success', 'Account Created!', 'success'))
            .catch((err) => Swal.fire('Error', err.message, 'error'));
    }
    function handleLogin() {
        const email = document.getElementById('login-email').value;
        const pass = document.getElementById('login-pass').value;
        if(!email || !pass) return;
        Swal.showLoading();
        auth.signInWithEmailAndPassword(email, pass).catch((err) => Swal.fire('Login Failed', err.message, 'error'));
    }
    function handleLogout() { auth.signOut().then(() => location.reload()); }

    auth.onAuthStateChanged((user) => {
        if (user) {
            currentUser = user;
            Swal.close();
            document.getElementById('auth-sec').classList.add('hidden');
            document.getElementById('app-content').classList.remove('hidden');
            loadUserData(user.uid);
            calculateUserStats(user.uid);
            loadAppContent();
        } else {
            document.getElementById('auth-sec').classList.remove('hidden');
            document.getElementById('app-content').classList.add('hidden');
        }
    });

    function loadUserData(uid) {
        db.collection('users').doc(uid).onSnapshot((doc) => {
            if (doc.exists) {
                const data = doc.data();
                userBalance = data.balance ? parseInt(data.balance) : 0;
                document.getElementById('header-balance').innerText = userBalance;
                document.getElementById('profile-name').innerText = data.name || "User";
                document.getElementById('profile-email').innerText = data.email;
                document.getElementById('profile-balance').innerText = userBalance;
            }
        });
    }

    function calculateUserStats(uid) {
        document.getElementById('profile-total-orders').innerText = "...";
        document.getElementById('profile-total-spent').innerText = "...";
        db.collection('orders').where('userId', '==', uid).get().then((snapshot) => {
            let totalOrders = 0;
            let totalSpent = 0;
            snapshot.forEach((doc) => {
                const data = doc.data();
                totalOrders++;
                const status = data.status ? data.status.toLowerCase() : '';
                if (status === 'success' || status === 'complete' || status === 'completed') {
                    totalSpent += parseInt(data.price || 0);
                }
            });
            document.getElementById('profile-total-orders').innerText = totalOrders;
            document.getElementById('profile-total-spent').innerText = totalSpent;
        }).catch(err => {
            document.getElementById('profile-total-orders').innerText = "0";
            document.getElementById('profile-total-spent').innerText = "0";
        });
    }

    function loadAppContent() {
        db.collection("settings").doc("global").onSnapshot((doc) => {
            if(doc.exists) {
                const data = doc.data();
                if(data.notice) document.getElementById('notice-text').innerText = data.notice;
                const waNum = (data.customerServiceLinks && data.customerServiceLinks.whatsapp) ? data.customerServiceLinks.whatsapp : "01700000000";
                const tgLink = (data.customerServiceLinks && data.customerServiceLinks.telegram) ? data.customerServiceLinks.telegram : "#";
                const appLink = data.appLink || "#";

                document.getElementById('home-whatsapp').href = "https://wa.me/" + waNum;
                document.getElementById('home-telegram').href = tgLink;
                const ftAppBtn = document.getElementById('ft-app-link');
                ftAppBtn.href = appLink;
                if(appLink !== "#") {
                    ftAppBtn.onclick = function(e) { e.preventDefault(); window.open(appLink, '_blank'); };
                }
                document.getElementById('ft-whatsapp').href = "https://wa.me/" + waNum;
                document.getElementById('ft-wa-num').innerText = waNum;
                document.getElementById('ft-telegram').href = tgLink;
                if(data.facebook) document.getElementById('ft-fb').href = data.facebook;
                if(data.instagram) document.getElementById('ft-insta').href = data.instagram;
                if(data.youtube) document.getElementById('ft-yt').href = data.youtube;
                document.getElementById('link-telegram').href = tgLink;
                document.getElementById('link-whatsapp').href = "https://wa.me/" + waNum;
            }
        });

        db.collection("services").onSnapshot((snapshot) => {
            const list = document.getElementById('services-list');
            list.innerHTML = "";
            gamesData = {}; 
            if(snapshot.empty) return list.innerHTML = `<div class="col-span-3 text-center text-gray-400">No Games Found</div>`;
            snapshot.forEach(doc => {
                const item = doc.data();
                gamesData[doc.id] = item; 
                list.innerHTML += `
                     <div onclick="openTopUpPage('${doc.id}', '${item.name}', '${item.image}')" 
                          class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer transform hover:-translate-y-1 transition-all duration-300 border border-gray-100 group">
                        <div class="w-full aspect-square bg-gray-50 overflow-hidden relative">
                            <img src="${item.image}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" 
                            onerror="this.src='https://placehold.co/200'">
                        </div>
                        <div class="p-2 text-center bg-white border-t border-gray-50">
                            <p class="text-[10px] font-bold text-gray-700 truncate">${item.name}</p>
                        </div>
                    </div>
                `;
            });
        });
        loadBanners();
        loadHistory();
        loadRecentOrdersGlobal(); 
    }

    function openTopUpPage(gameId, gameName, gameImg) {
        selectedGameId = gameId;
        selectedGameName = gameName;
        selectedProduct = null;
        document.getElementById('total-price').innerText = "0";
        document.getElementById('game-player-id').value = "";
        document.getElementById('topup-game-title').innerText = gameName;
        document.getElementById('topup-sub-title').innerText = gameName + " ";
        document.getElementById('topup-game-img').src = gameImg;
        const rulesBox = document.getElementById('game-rules-box');
        const rulesText = document.getElementById('game-rules-text');
        if(gamesData[gameId] && gamesData[gameId].rules) {
            rulesText.innerText = gamesData[gameId].rules;
            rulesBox.classList.remove('hidden');
        } else {
            rulesBox.classList.add('hidden');
        }
        showSec('topup');
        const grid = document.getElementById('products-grid');
        const loader = document.getElementById('product-loader');
        grid.innerHTML = "";
        loader.classList.remove('hidden');
        db.collection('services').doc(gameId).collection('products').orderBy('price', 'asc').get()
            .then((snapshot) => {
                loader.classList.add('hidden');
                if(snapshot.empty) {
                    grid.innerHTML = `<div class="col-span-2 text-center text-gray-400 py-4">No packages available</div>`;
                    return;
                }
                snapshot.forEach(doc => {
                    const prod = doc.data();
                    const card = document.createElement('div');
                    card.className = "product-card";
                    card.onclick = () => selectProduct(card, prod.name, prod.price, doc.id);
                    card.innerHTML = `
                        <div class="flex items-center">
                            <div class="product-bullet"></div>
                            <span class="text-xs font-bold text-gray-600">${prod.name}</span>
                        </div>
                        <span class="text-pink-600 font-bold text-sm">৳${prod.price}</span>
                    `;
                    grid.appendChild(card);
                });
            });
    }

    function selectProduct(element, name, price, id) {
        document.querySelectorAll('.product-card').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
        selectedProduct = { id: id, name: name, price: parseInt(price) };
        document.getElementById('total-price').innerText = selectedProduct.price;
    }

    function processOrder() {
        const playerId = document.getElementById('game-player-id').value.trim();
        if(!playerId) return Swal.fire({ icon: 'warning', title: 'Missing ID', text: 'Please enter Player ID!' });
        if(!selectedProduct) return Swal.fire({ icon: 'warning', title: 'Select Pack', text: 'Please select a recharge package!' });

        Swal.fire({
            title: 'Confirm Purchase?',
            html: `UID: <b>${playerId}</b><br>Package: ${selectedProduct.name}<br>Price: ৳${selectedProduct.price}`,
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: '#ec4899',
            confirmButtonText: 'Yes, Buy Now'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.showLoading();
                const userRef = db.collection('users').doc(currentUser.uid);
                const orderRef = db.collection('orders').doc(); 
                db.runTransaction((transaction) => {
                    return transaction.get(userRef).then((userDoc) => {
                        if (!userDoc.exists) throw "User does not exist!";
                        const userData = userDoc.data();
                        const currentBal = parseInt(userData.balance) || 0;
                        const productPrice = parseInt(selectedProduct.price);
                        if (currentBal < productPrice) throw "Insufficient Balance! Please add money.";
                        const newBalance = currentBal - productPrice;
                        transaction.update(userRef, { balance: newBalance });
                        transaction.set(orderRef, {
                            userId: currentUser.uid,
                            userName: currentUser.email,
                            gameName: selectedGameName,
                            gameId: selectedGameId,
                            playerId: playerId,
                            productName: selectedProduct.name,
                            price: productPrice,
                            status: 'pending',
                            date: new Date()
                        });
                    });
                })
                .then(() => {
                    Swal.fire({ title: 'Success!', text: 'Order Placed Successfully!', icon: 'success', confirmButtonText: 'OK' }).then(() => { location.reload(); });
                })
                .catch((err) => {
                    console.error("Order Failed: ", err);
                    Swal.fire('Error', typeof err === 'string' ? err : err.message, 'error');
                });
            }
        });
    }

    function showSec(secId) {
        // Handle Islamic Hub Isolation
        if (secId === 'islamic') {
            document.getElementById('main-nav').classList.add('hidden'); // Hide Main Nav
            document.getElementById('main-header').classList.add('hidden'); // Hide Main Header
            document.getElementById('main-notice').classList.add('hidden'); // Hide Notice
            
            document.getElementById('islamic-sec').classList.remove('hidden'); // Show Full Screen Islamic
            if (!islamicInitialized) initIslamic();
            return; // Stop here, no need to process other tabs
        } else {
            // Restore Global Elements
            document.getElementById('islamic-sec').classList.add('hidden'); 
            document.getElementById('main-nav').classList.remove('hidden'); 
            document.getElementById('main-header').classList.remove('hidden');
            document.getElementById('main-notice').classList.remove('hidden');
            
            // Standard Tab Switching Logic
            document.querySelectorAll('main > section').forEach(s => {
                if(s.id !== 'islamic-sec') s.classList.add('hidden');
            });
            
            document.querySelectorAll('#main-nav .nav-item').forEach(n => n.classList.remove('active-tab'));
            
            const targetSec = document.getElementById(secId + '-sec');
            if(targetSec) targetSec.classList.remove('hidden');
            
            const navBtn = document.getElementById('nav-' + secId);
            if(navBtn) navBtn.classList.add('active-tab');
        }

        if(secId === 'addmoney') resetAddMoney();
        if(secId === 'history') loadHistory();
        if(secId === 'deposit-history') loadDepositHistory();
    }

    let selectedAutoMethod = null;
    function toggleAddMoneyMode(mode) {
        document.getElementById('pay-mode-selection').classList.add('hidden');
        document.getElementById('btn-back-selection').classList.remove('hidden');
        if (mode === 'auto') {
            document.getElementById('auto-pay-form').classList.remove('hidden');
            document.getElementById('manual-pay-form').classList.add('hidden');
        } else {
            document.getElementById('manual-pay-form').classList.remove('hidden');
            document.getElementById('auto-pay-form').classList.add('hidden');
        }
    }
    function resetAddMoney() {
        document.getElementById('pay-mode-selection').classList.remove('hidden');
        document.getElementById('btn-back-selection').classList.add('hidden');
        document.getElementById('auto-pay-form').classList.add('hidden');
        document.getElementById('manual-pay-form').classList.add('hidden');
        resetManualForm();
        document.getElementById('auto-pay-details').classList.add('hidden');
        document.getElementById('auto-trx-id').value = "";
        document.querySelectorAll('.method-card').forEach(el => el.classList.remove('selected-method'));
        selectedAutoMethod = null;
    }
    function selectAutoMethod(method) {
        selectedAutoMethod = method;
        document.querySelectorAll('.method-card').forEach(el => el.classList.remove('selected-method'));
        document.getElementById('auto-card-' + method).classList.add('selected-method');
        document.getElementById('auto-pay-details').classList.remove('hidden');
        const num = globalPaymentNumbers[method.toLowerCase()];
        document.getElementById('auto-pay-number').innerText = num || "Not Set";
    }
    function copyAutoNumber() {
        navigator.clipboard.writeText(document.getElementById('auto-pay-number').innerText);
        Swal.fire({toast:true, title:'Copied', icon:'success', position:'top-end', showConfirmButton:false, timer:1000});
    }
    function handleAutoPayVerify() {
        const trxInput = document.getElementById('auto-trx-id').value.trim();
        if (!trxInput) return Swal.fire('Error', 'Enter Transaction ID', 'warning');
        if (!selectedAutoMethod) return Swal.fire('Error', 'Select Method', 'warning');
        Swal.fire({ title: 'Verifying...', didOpen: () => Swal.showLoading() });
        db.collection('used_trx').doc(trxInput).get().then((docSnapshot) => {
            if (docSnapshot.exists) throw new Error('এই ট্রানজেকশন আইডিটি ইতিমধ্যে ব্যবহারিত হয়েছে');
            return db.collection('deposits').where('trxId', '==', trxInput).get();
        })
        .then((manualSnapshot) => {
             if (!manualSnapshot.empty) throw new Error('এই ট্রানজেকশন আইডিটি ইতিমধ্যে ম্যানুয়াল পেমেন্টে ব্যবহার করা হয়েছে');
            return rdb.ref('XNXANIKPAY').orderByChild('txid').equalTo(trxInput).once('value');
        })
        .then((snapshot) => {
            if (snapshot.exists()) {
                let foundData = null;
                snapshot.forEach((childSnapshot) => { foundData = childSnapshot.val(); });
                if (foundData) {
                    const amount = parseFloat(foundData.amount);
                    const userRef = db.collection('users').doc(currentUser.uid);
                    const trxRef = db.collection('used_trx').doc(trxInput);
                    const orderRef = db.collection('deposits').doc(); 
                    db.runTransaction((transaction) => {
                        return transaction.get(userRef).then((userDoc) => {
                            const currentBal = userDoc.data().balance || 0;
                            const newBal = currentBal + amount;
                            transaction.update(userRef, { balance: newBal });
                            transaction.set(trxRef, { uid: currentUser.uid, usedAt: new Date(), amount: amount, method: selectedAutoMethod });
                            transaction.set(orderRef, { userId: currentUser.uid, amount: amount, trxId: trxInput, status: 'approved', date: new Date(), method: selectedAutoMethod + " (Auto)" });
                        });
                    }).then(() => {
                        Swal.fire({ title: 'Payment Successful!', text: `৳${amount} Added to your wallet.`, icon: 'success' }).then(() => { location.reload(); });
                    }).catch((err) => Swal.fire('Error', 'Update Failed: ' + err.message, 'error'));
                } else { Swal.fire('Error', 'Invalid Data Structure', 'error'); }
            } else { Swal.fire('Failed', 'আপনার দেওয়া TRX ID খুজে পাওয়া যায়নি। দয়া করে কিছুক্ষণ পর আবার চেষ্টা করুন অথবা সাপোর্ট এ যোগাযোগ করুন। ধন্যবাদ ❤️‍🩹', 'error'); }
        })
        .catch((err) => Swal.fire('Error', err.message, 'error'));
    }

    function showPaymentForm(methodName, logoUrl, color) {
        document.getElementById('payment-methods-grid').classList.add('hidden');
        document.getElementById('payment-form-container').classList.remove('hidden');
        document.getElementById('form-logo').src = logoUrl;
        document.getElementById('form-method-name').innerText = methodName;
        db.collection("settings").doc("global").get().then(doc => {
            if(doc.exists && doc.data().payment_numbers) {
                const num = doc.data().payment_numbers[methodName.toLowerCase()];
                document.getElementById('admin-number').innerText = num || "Not Set";
            } else { document.getElementById('admin-number').innerText = "Not Available"; }
        });
    }
    function resetManualForm() {
        document.getElementById('payment-methods-grid').classList.remove('hidden');
        document.getElementById('payment-form-container').classList.add('hidden');
        document.getElementById('dep-trx').value = "";
        document.getElementById('dep-amount').value = "";
    }
    function submitDeposit() {
        const amt = document.getElementById('dep-amount').value;
        const trx = document.getElementById('dep-trx').value.trim();
        const method = document.getElementById('form-method-name').innerText;
        if(!amt || !trx) return Swal.fire('Error', 'Fill all fields', 'warning');
        Swal.showLoading();
        db.collection('used_trx').doc(trx).get()
        .then((autoSnap) => {
            if(autoSnap.exists) throw new Error("This TrxID was already used in Auto Pay.");
            return db.collection('deposits').where('trxId', '==', trx).get();
        })
        .then((manualSnap) => {
            if(!manualSnap.empty) throw new Error("This TrxID is already submitted.");
            return db.collection('deposits').add({
                userId: currentUser.uid, amount: parseInt(amt), trxId: trx, status: 'pending', date: new Date(), userEmail: currentUser.email, method: method + " (Manual)"
            });
        })
        .then(() => {
            Swal.fire('Submitted', 'Request submitted for approval.', 'success');
            resetManualForm();
            resetAddMoney();
        })
        .catch((err) => { Swal.fire('Failed', err.message, 'error'); });
    }
    function copyNumber() {
        navigator.clipboard.writeText(document.getElementById('admin-number').innerText);
        Swal.fire({toast:true, title:'Copied', icon:'success', position:'top-end', showConfirmButton:false, timer:1000});
    }

    function loadDepositHistory() {
        const list = document.getElementById('deposit-history-list');
        if(!currentUser) return;
        list.innerHTML = '<div class="text-center py-4"><i class="fas fa-spinner fa-spin text-pink-500"></i> Loading...</div>';
        db.collection('deposits').where('userId', '==', currentUser.uid).limit(20).get().then(snapshot => {
            list.innerHTML = "";
            if(snapshot.empty) { list.innerHTML = `<div class="text-center py-10 text-gray-400"><p>No deposit history found.</p></div>`; return; }
            let logs = [];
            snapshot.forEach(doc => logs.push(doc.data()));
            logs.sort((a, b) => { let dateA = a.date && a.date.toDate ? a.date.toDate() : new Date(a.date); let dateB = b.date && b.date.toDate ? b.date.toDate() : new Date(b.date); return dateB - dateA; });
            logs.forEach(d => {
                let statusColor = "bg-yellow-100 text-yellow-700";
                if (d.status === 'approved' || d.status === 'success') statusColor = "bg-green-100 text-green-700";
                else if (d.status === 'rejected') statusColor = "bg-red-100 text-red-700";
                let dateStr = "N/A";
                if (d.date) { const dateObj = d.date.toDate ? d.date.toDate() : new Date(d.date); dateStr = dateObj.toLocaleString('en-US', { month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric' }); }
                list.innerHTML += `
                    <div class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center">
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold text-gray-800 uppercase">${d.method || 'Unknown'}</span>
                                <span class="${statusColor} text-[9px] font-bold px-1.5 py-0.5 rounded uppercase">${d.status}</span>
                            </div>
                            <p class="text-[10px] text-gray-400 font-mono">TRX: ${d.trxId || d.trx_id}</p>
                            <p class="text-[10px] text-gray-400">${dateStr}</p>
                        </div>
                        <div class="text-right">
                            <span class="text-lg font-bold text-gray-800">৳${d.amount}</span>
                        </div>
                    </div>`;
            });
        });
    }

    function loadHistory() {
        const list = document.getElementById('history-list');
        if(!currentUser) return;
        list.innerHTML = '<div class="text-center py-4"><i class="fas fa-spinner fa-spin text-pink-500"></i> Loading...</div>';
        db.collection('orders').where('userId', '==', currentUser.uid).limit(20).get().then(snapshot => {
            list.innerHTML = "";
            if(snapshot.empty) { list.innerHTML = `<div class="flex flex-col items-center justify-center py-10 text-gray-400"><p>No orders found yet.</p></div>`; return; }
            let orders = [];
            snapshot.forEach(doc => orders.push(doc.data()));
            orders.sort((a, b) => { let dateA = a.date && a.date.toDate ? a.date.toDate() : new Date(a.date); let dateB = b.date && b.date.toDate ? b.date.toDate() : new Date(b.date); return dateB - dateA; });
            orders.forEach(d => {
                let statusColor = "bg-yellow-100 text-yellow-700 border-yellow-500";
                let icon = "fa-clock";
                if (d.status === 'success' || d.status === 'complete') { statusColor = "bg-green-100 text-green-700 border-green-500"; icon = "fa-check-circle"; } 
                else if (d.status === 'cancel' || d.status === 'rejected' || d.status === 'refunded') { statusColor = "bg-red-100 text-red-700 border-red-500"; icon = "fa-times-circle"; }
                let dateStr = "N/A";
                if (d.date) { const dateObj = d.date.toDate ? d.date.toDate() : new Date(d.date); const options = { month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric', hour12: true }; dateStr = dateObj.toLocaleString('en-US', options); }
                list.innerHTML += `
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 mb-4 overflow-hidden relative">
                        <div class="absolute left-0 top-0 bottom-0 w-1.5 ${statusColor.split(' ')[2]}"></div>
                        <div class="p-3 pl-4">
                            <div class="flex justify-between items-start mb-2">
                                <div><h4 class="font-bold text-gray-800 text-sm flex items-center gap-1"><i class="fas fa-gamepad text-pink-500 text-xs"></i> ${d.gameName}</h4><p class="text-[10px] text-gray-400 mt-0.5"><i class="far fa-calendar-alt"></i> ${dateStr}</p></div>
                                <span class="${statusColor.split(' border')[0]} text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide flex items-center gap-1"><i class="fas ${icon}"></i> ${d.status}</span>
                            </div>
                            <div class="h-px bg-gray-100 w-full my-2"></div>
                            <div class="flex justify-between items-center">
                                <div><p class="text-xs font-bold text-gray-700">${d.productName}</p><div class="mt-1 inline-block bg-gray-50 border border-gray-200 rounded px-2 py-0.5"><p class="text-[10px] text-gray-500 font-mono">UID: <span class="text-gray-700 font-bold select-all">${d.playerId}</span></p></div></div>
                                <div class="text-right"><p class="text-[10px] text-gray-400 mb-0.5">Price</p><p class="text-lg font-bold text-pink-600">৳${d.price}</p></div>
                            </div>
                        </div>
                    </div>`;
            });
        });
    }

    function loadRecentOrdersGlobal() {
        const container = document.getElementById('latest-orders-list');
        db.collection('orders').orderBy('date', 'desc').limit(5).onSnapshot((snapshot) => {
              if (snapshot.empty) { container.innerHTML = '<div class="text-center text-gray-400 text-xs py-2">No recent orders</div>'; return; }
              container.innerHTML = "";
              snapshot.forEach(doc => {
                  const data = doc.data();
                  let displayName = "Customer";
                  if(data.userName) displayName = data.userName.includes('@') ? data.userName.split('@')[0] : data.userName;
                  const firstChar = displayName.charAt(0).toUpperCase();
                  let statusBadge = 'bg-[#ffc107] text-gray-800';
                  let statusText = data.status || 'pending';
                  if (statusText === 'success' || statusText === 'complete') { statusBadge = 'bg-[#198754] text-white'; statusText = 'completed'; }
                  else if (statusText !== 'pending' && statusText !== 'processing') { statusBadge = 'bg-red-500 text-white'; }
                  container.innerHTML += `
                    <div class="bg-white p-3 rounded-xl shadow-[0_2px_10px_rgba(0,0,0,0.03)] border border-gray-100 flex items-center justify-between">
                        <div class="flex items-center gap-3 overflow-hidden">
                            <div class="w-11 h-11 min-w-[44px] bg-[#0d6efd] rounded-full flex items-center justify-center text-white text-lg font-sans font-medium shadow-sm">${firstChar}</div>
                            <div class="flex flex-col truncate"><span class="text-gray-600 font-bold text-sm truncate">${displayName}</span><span class="text-gray-500 text-[11px] font-medium truncate">${data.productName} - ${data.price} ৳</span></div>
                        </div>
                        <div class="${statusBadge} px-3 py-1 rounded-full text-[10px] font-bold capitalize shadow-sm whitespace-nowrap ml-2">${statusText}</div>
                    </div>`;
              });
          });
    }

    function toggleSupportModal() { document.getElementById('support-modal').classList.toggle('hidden'); }
    function loadBanners() { db.collection("banners").onSnapshot((snapshot) => { const wrapper = document.getElementById('slider-wrapper'); let slidesHTML = ""; snapshot.forEach((doc) => { if(doc.data().image) slidesHTML += `<img src="${doc.data().image}" class="w-full h-full object-cover flex-shrink-0">`; }); if(slidesHTML) { wrapper.innerHTML = slidesHTML; startSlider(); } }); }
    function startSlider() { let idx = 0; const wrapper = document.getElementById('slider-wrapper'); const count = wrapper.children.length; if(count > 0) { setInterval(() => { idx = (idx + 1) % count; wrapper.style.transform = `translateX(-${idx * 100}%)`; }, 3000); } }

    /* =========================================
       ISLAMIC HUB LOGIC (Green Theme Updated)
       ========================================= */
       
    let islamicInitialized = false;
    const HIJRI_MONTHS_BN = { "Muharram": "মুহাররম", "Safar": "সফর", "Rabi' al-awwal": "রবিউল আউয়াল", "Rabi' al-thani": "রবিউস সানি", "Jumada al-ula": "জমাদিউল আউয়াল", "Jumada al-akhira": "জমাদিউস সানি", "Rajab": "রজব", "Sha'ban": "শাবান", "Ramadan": "রমজান", "Shawwal": "শাওয়াল", "Dhu al-Qi'dah": "জিলকদ", "Dhu al-Hijjah": "জিলহজ্জ" };
    const DUAS = [
        { title: "আয়াতুল কুরসি", arabic: "اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ...", pronunciation: "আল্লাহু লা ইলাহা ইল্লা হুয়াল হাইয়ুল কাইয়ুম...", meaning: "আল্লাহ, তিনি ছাড়া অন্য কোনো উপাস্য নেই..." },
        { title: "সাইয়্যিদুল ইস্তিগফার", arabic: "اللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ...", pronunciation: "আল্লাহুম্মা আন্তা রাব্বি লা ইলাহা ইল্লা আন্তা...", meaning: "হে আল্লাহ! আপনিই আমার প্রতিপ্রতিপালক..." }
    ];
    
    // UPDATED: All 99 Names added here
    const ALLAH_NAMES = [
        { ar: "الله", bn: "আল্লাহ", meaning: "একমাত্র উপাস্য" },
        { ar: "الرَّحْمَنُ", bn: "আর-রহমান", meaning: "পরম দয়ালু" },
        { ar: "الرَّحِيمُ", bn: "আর-রহিম", meaning: "অতি দয়ালু" },
        { ar: "الْمَلِكُ", bn: "আল-মালিক", meaning: "সর্বাধিপতি" },
        { ar: "الْقُدُّوسُ", bn: "আল-কুদ্দুস", meaning: "নিষ্কলুষ, অতি পবিত্র" },
        { ar: "السَّلَامُ", bn: "আস-সালাম", meaning: "নিরাপত্তা দানকারী" },
        { ar: "الْمُؤْمِنُ", bn: "আল-মুমিন", meaning: "নিরাপত্তা ও ঈমান দানকারী" },
        { ar: "الْمُهَيْمِنُ", bn: "আল-মুহাইমিন", meaning: "পরিপুর্ন রক্ষণাবেক্ষণকারী" },
        { ar: "الْعَزِيزُ", bn: "আল-আজিজ", meaning: "পরাক্রমশালী" },
        { ar: "الْجَبَّارُ", bn: "আল-জাব্বার", meaning: "দুর্নিবার, প্রতাপশালী" },
        { ar: "الْمُتَكَبِّرُ", bn: "আল-মুতাকাব্বির", meaning: "গৌরবান্বিত" },
        { ar: "الْخَالِقُ", bn: "আল-খালিক", meaning: "সৃষ্টির্তা" },
        { ar: "الْبَارِئُ", bn: "আল-বারি", meaning: "সঠিকভাবে সৃষ্টিকারী" },
        { ar: "الْمُصَوِّرُ", bn: "আল-মুসাব্বির", meaning: "আকৃতি দানকারী" },
        { ar: "الْغَفَّارُ", bn: "আল-গাফফার", meaning: "পরম ক্ষমাশীল" },
        { ar: "الْقَهَّارُ", bn: "আল-কাহহার", meaning: "কঠোর হুকুমদাতা" },
        { ar: "الْوَهَّابُ", bn: "আল-ওয়াহহাব", meaning: "সবকিছু দানকারী" },
        { ar: "الرَّزَّاقُ", bn: "আর-রাজ্জাক", meaning: "রিজিকদাতা" },
        { ar: "الْفَتَّاحُ", bn: "আল-ফাত্তাহ", meaning: "বিজয়দানকারী" },
        { ar: "الْعَلِيمُ", bn: "আল-আলিম", meaning: "সর্বজ্ঞ" },
        { ar: "الْقَابِضُ", bn: "আল-কাবিদ", meaning: "সংকীর্ণকারী" },
        { ar: "الْبَاسِطُ", bn: "আল-বাসিত", meaning: "প্রশস্তকারী" },
        { ar: "الْخَافِضُ", bn: "আল-খা-ফিদ", meaning: "অবনতকারী" },
        { ar: "الرَّافِعُ", bn: "আর-রাফি", meaning: "উন্নতকারী" },
        { ar: "الْمُعِزُّ", bn: "আল-মুইজ্জ", meaning: "সম্মান দাতা" },
        { ar: "الْمُذِلُّ", bn: "আল-মুযিল্ল", meaning: "অপমানকারী" },
        { ar: "السَّمِيعُ", bn: "আস-সামি", meaning: "সর্বশ্রোতা" },
        { ar: "الْبَصِيرُ", bn: "আল-বাসির", meaning: "সর্বদ্রষ্টা" },
        { ar: "الْحَكَمُ", bn: "আল-হাকাম", meaning: "চূড়ান্ত ফয়সালাকারী" },
        { ar: "الْعَدْلُ", bn: "আল-আদল", meaning: "ন্যায়বিচারক" },
        { ar: "اللَّطِيفُ", bn: "আল-লাতিফ", meaning: "সূক্ষ্মদর্শী" },
        { ar: "الْخَبِيرُ", bn: "আল-খাবির", meaning: "মহা সংবাদ" },
        { ar: "الْحَلِيمُ", bn: "আল-হালিম", meaning: "ধৈর্যশীল" },
        { ar: "الْعَظِيمُ", bn: "আল-আজিম", meaning: "সুমহান" },
        { ar: "الْغَفُورُ", bn: "আল-গফুর", meaning: "ক্ষমাশীল" },
        { ar: "الشَّكُورُ", bn: "আস-শাকুর", meaning: "গুণগ্রাহী" },
        { ar: "الْعَلِيُّ", bn: "আল-আলি", meaning: "উচ্চ মর্যাদাবান" },
        { ar: "الْكَبِيرُ", bn: "আল-কাবির", meaning: "সুমহান" },
        { ar: "الْحَفِيظُ", bn: "আল-হাফিজ", meaning: "সংরক্ষণকারী" },
        { ar: "الْمُقِيتُ", bn: "আল-মুকিত", meaning: "সকলের রিযিকদাতা" },
        { ar: "الْحَسِيبُ", bn: "আল-হাসিব", meaning: "হিসাব গ্রহণকারী" },
        { ar: "الْجَلِيلُ", bn: "আল-জলিল", meaning: "মর্যাদাবান" },
        { ar: "الْكَرِيمُ", bn: "আল-কারিম", meaning: "মহান দাতা" },
        { ar: "الرَّقِيبُ", bn: "আর-রাকিব", meaning: "তত্ত্বাবধায়ক" },
        { ar: "الْمُجِيبُ", bn: "আল-মুজিব", meaning: "কবুলকারী" },
        { ar: "الْوَاسِعُ", bn: "আল-ওয়াসি", meaning: "সর্বব্যাপী" },
        { ar: "الْحَكِيمُ", bn: "আল-হাকিম", meaning: "প্রজ্ঞাময়" },
        { ar: "الْوَدُودُ", bn: "আল-ওয়াদুদ", meaning: "প্রেমময়" },
        { ar: "الْمَجِيدُ", bn: "আল-মাজিদ", meaning: "গৌরবান্বিত" },
        { ar: "الْبَاعِثُ", bn: "আল-বাইছ", meaning: "পুনরুজ্জীবিতকারী" },
        { ar: "الشَّهِيدُ", bn: "আশ-শাহিদ", meaning: "সাক্ষী" },
        { ar: "الْحَقُّ", bn: "আল-হাক্ক", meaning: "সত্য" },
        { ar: "الْوَكِيلُ", bn: "আল-ওয়াকিল", meaning: "উকিল" },
        { ar: "الْقَوِيُّ", bn: "আল-কবি", meaning: "শক্তিশালী" },
        { ar: "الْمَتِينُ", bn: "আল-মাতিন", meaning: "দৃঢ়" },
        { ar: "الْوَلِيُّ", bn: "আল-ওয়ালি", meaning: "অভিভাবক" },
        { ar: "الْحَمِيدُ", bn: "আল-হামিদ", meaning: "প্রশংসিত" },
        { ar: "الْمُحْصِي", bn: "আল-মুহসি", meaning: "হিসাব রক্ষাকারী" },
        { ar: "الْمُبْدِئُ", bn: "আল-মুবদি", meaning: "প্রথম সৃষ্টিকারী" },
        { ar: "الْمُعِيدُ", bn: "আল-মুঈদ", meaning: "পুনরায় সৃষ্টিকারী" },
        { ar: "الْمُحْيِي", bn: "আল-মুহায়ই", meaning: "জীবনদানকারী" },
        { ar: "الْمُمِيتُ", bn: "আল-মুমিত", meaning: "মৃত্যুদানকারী" },
        { ar: "الْحَيُّ", bn: "আল-হাইয়ু", meaning: "চিরঞ্জীব" },
        { ar: "الْقَيُّومُ", bn: "আল-কাইয়ুম", meaning: "চিরস্থায়ী" },
        { ar: "الْوَاجِدُ", bn: "আল-ওয়াজিদ", meaning: "অস্তিত্ববান" },
        { ar: "الْمَاجِدُ", bn: "আল-মাজিদ", meaning: "মহিমান্বিত" },
        { ar: "الْوَاحِدُ", bn: "আল-ওয়াহিদ", meaning: "এক ও অদ্বিতীয়" },
        { ar: "الصَّمَدُ", bn: "আস-সামাদ", meaning: "অমুখাপেক্ষী" },
        { ar: "الْقَادِرُ", bn: "আল-কাদির", meaning: "ক্ষমতাবান" },
        { ar: "الْمُقْتَدِرُ", bn: "আল-মুক্তাদির", meaning: "প্রভাবশালী" },
        { ar: "الْمُقَدِّمُ", bn: "আল-মুকাদ্দিম", meaning: "অগ্রবর্তীকারী" },
        { ar: "الْمُؤَخِّرُ", bn: "আল-মুয়াক্ষির", meaning: "পশ্চাদবর্তীকারী" },
        { ar: "الْأَوَّلُ", bn: "আল-আউয়াল", meaning: "অনাদি" },
        { ar: "الْآخِرُ", bn: "আল-আখির", meaning: "অনন্ত" },
        { ar: "الظَّاهِرُ", bn: "আজ-জাহির", meaning: "প্রকাশ্য" },
        { ar: "الْبَاطِنُ", bn: "আল-বাতিন", meaning: "গোপন" },
        { ar: "الْوَالِي", bn: "আল-ওয়ালি", meaning: "অভিভাবক" },
        { ar: "الْمُتَعَالِي", bn: "আল-মুতাআলি", meaning: "সর্বোচ্চ" },
        { ar: "الْبَرُّ", bn: "আল-বার্", meaning: "কল্যাণময়" },
        { ar: "التَّوَّابُ", bn: "আত-তাওয়াব", meaning: "তওবা কবুলকারী" },
        { ar: "الْمُنْتَقِمُ", bn: "আল-মুনতাকিম", meaning: "প্রতিশোধ গ্রহণকারী" },
        { ar: "الْعَفُوُّ", bn: "আল-আফুউ", meaning: "ক্ষমাশীল" },
        { ar: "الرَّءُوفُ", bn: "আর-রউফ", meaning: "স্নেহশীল" },
        { ar: "مَالِكُ الْمُلْكِ", bn: "মালিকুল মুলক", meaning: "জগৎসমূহের মালিক" },
        { ar: "ذُو الْجَلَالِ وَالْإِكْرَامِ", bn: "জুল-জালালি-ওয়াল-ইকরাম", meaning: "মহিমাময় ও মহানুভব" },
        { ar: "الْمُقْسِطُ", bn: "আল-মুকসিত", meaning: "ন্যায়পরায়ণ" },
        { ar: "الْجَامِعُ", bn: "আল-জামিউ", meaning: "একত্রকারী" },
        { ar: "الْغَنِيُّ", bn: "আল-গনি", meaning: "ধনী" },
        { ar: "الْمُغْنِي", bn: "আল-মুগনি", meaning: "অভাবমোচনকারী" },
        { ar: "الْمَانِعُ", bn: "আল-মানিউ", meaning: "বারণকারী" },
        { ar: "الضَّارُّ", bn: "আদ-দর্", meaning: "ক্ষতিকারী" },
        { ar: "النَّافِعُ", bn: "আন-নাফি", meaning: "কল্যাণকারী" },
        { ar: "النُّورُ", bn: "আন-নূর", meaning: "জ্যোতি" },
        { ar: "الْهَادِي", bn: "আল-হাদি", meaning: "পথপ্রদর্শক" },
        { ar: "الْبَدِيعُ", bn: "আল-বাদি", meaning: "অতুলনীয়" },
        { ar: "الْبَاقِي", bn: "আল-বাকি", meaning: "চিরস্থায়ী" },
        { ar: "الْوَارِثُ", bn: "আল-ওয়ারিস", meaning: "উত্তরাধিকারী" },
        { ar: "الرَّشِيدُ", bn: "আর-রশিদ", meaning: "সঠিক পথের দিশারী" },
        { ar: "الصَّبُورُ", bn: "আস-সাবুর", meaning: "ধৈর্যশীল" }
    ];

    let prayerProgress = JSON.parse(localStorage.getItem('al_mubin_progress')) || { fajr: false, dhuhr: false, asr: false, maghrib: false, isha: false };
    let cachedTimings = null;

    function initIslamic() {
        document.getElementById('islamic-loading').classList.remove('hidden');
        document.getElementById('islamic-loading').classList.add('flex');
        getLocation();
        renderDuas();
        renderNames();
        fetchQuran();
        updateTracker();
        setupAudioPlayer();
        islamicInitialized = true;
        setTimeout(() => {
            document.getElementById('islamic-loading').classList.add('hidden');
            document.getElementById('islamic-loading').classList.remove('flex');
        }, 800);
    }
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                pos => fetchPrayerTimes(pos.coords.latitude, pos.coords.longitude),
                err => fetchPrayerTimes(23.8103, 90.4125)
            );
        } else fetchPrayerTimes(23.8103, 90.4125);
    }
    async function fetchPrayerTimes(lat, lng) {
        try {
            const date = new Date().toLocaleDateString('en-GB').split('/').reverse().join('-');
            const res = await fetch(`https://api.aladhan.com/v1/timings/${date}?latitude=${lat}&longitude=${lng}&method=2`);
            const data = await res.json();
            cachedTimings = data.data.timings;
            renderPrayerTimes(cachedTimings);
            renderHijri(data.data.date.hijri);
            startNextPrayerCountdown();
        } catch (e) { console.error("API Error", e); }
    }
    function convertTo12H(time) {
        if(!time) return "--:--";
        let [h, m] = time.split(':');
        let ampm = h >= 12 ? 'PM' : 'AM';
        h = h % 12 || 12;
        return `${h}:${m} ${ampm}`;
    }
    function renderPrayerTimes(times) {
        document.getElementById('time-imsak').innerText = convertTo12H(times.Imsak);
        document.getElementById('time-maghrib').innerText = convertTo12H(times.Maghrib);
        const grid = [
            {n: 'ফজর', t: times.Fajr, i: '🌅'}, {n: 'যোহর', t: times.Dhuhr, i: '☀️'}, {n: 'আসর', t: times.Asr, i: '🌤️'},
            {n: 'মাগরিব', t: times.Maghrib, i: '🌇'}, {n: 'এশা', t: times.Isha, i: '🌙'}, {n: 'সূর্যোদয়', t: times.Sunrise, i: '🔆'}
        ];
        document.getElementById('prayer-times-grid').innerHTML = grid.map(p => `
            <div class="bg-white p-4 rounded-3xl shadow-sm border border-emerald-100 flex flex-col items-center">
                <span class="text-xl mb-1">${p.i}</span>
                <span class="text-[10px] font-bold text-slate-400 uppercase">${p.n}</span>
                <span class="text-[13px] font-black text-emerald-900">${convertTo12H(p.t)}</span>
            </div>
        `).join('');
    }
    function renderHijri(hijri) {
        document.getElementById('hijri-month').innerText = HIJRI_MONTHS_BN[hijri.month.en] || hijri.month.en;
        document.getElementById('hijri-day').innerText = hijri.day;
        document.getElementById('hijri-year-bn').innerText = `${hijri.year} হিজরি`;
    }
    function startNextPrayerCountdown() {
        if (!cachedTimings) return;
        const updateNext = () => {
            const now = new Date();
            const prayers = [
                {n: 'ফজর', t: cachedTimings.Fajr}, {n: 'যোহর', t: cachedTimings.Dhuhr}, {n: 'আসর', t: cachedTimings.Asr},
                {n: 'মাগরিব', t: cachedTimings.Maghrib}, {n: 'এশা', t: cachedTimings.Isha}
            ];
            let next = null;
            for (let p of prayers) {
                const [h, m] = p.t.split(':');
                const pDate = new Date(); pDate.setHours(h, m, 0);
                if (pDate > now) { next = { ...p, date: pDate }; break; }
            }
            if (!next) { 
                const [h, m] = prayers[0].t.split(':');
                const pDate = new Date(); pDate.setDate(pDate.getDate() + 1); pDate.setHours(h, m, 0);
                next = { ...prayers[0], date: pDate };
            }
            const diff = next.date - now;
            const hh = Math.floor(diff / 3600000);
            const mm = Math.floor((diff % 3600000) / 60000);
            document.getElementById('next-prayer-info').innerText = `${next.n}: ${hh} ঘণ্টা ${mm} মি. বাকি`;
        };
        updateNext(); setInterval(updateNext, 60000);
    }
    function updateTracker() {
        const keys = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'];
        const names = {fajr:'ফজর', dhuhr:'যোহর', asr:'আসর', maghrib:'মাগরিব', isha:'এশা'};
        const count = keys.filter(k => prayerProgress[k]).length;
        const pct = (count / 5) * 100;
        document.getElementById('tracker-percent').innerText = `${pct}%`;
        document.getElementById('tracker-progress-bar').style.width = `${pct}%`;
        document.getElementById('tracker-buttons').innerHTML = keys.map(k => `
            <button onclick="togglePrayer('${k}')" class="flex flex-col items-center py-2 rounded-2xl border transition-all duration-300 ${prayerProgress[k] ? 'prayer-card completed' : 'bg-emerald-800/40 border-emerald-700/50 text-emerald-200'}">
                <span class="text-[9px] font-black">${names[k]}</span>
            </button>
        `).join('');
        localStorage.setItem('al_mubin_progress', JSON.stringify(prayerProgress));
    }
    function togglePrayer(k) { prayerProgress[k] = !prayerProgress[k]; updateTracker(); }
    const audio = document.getElementById('global-audio');
    function setupAudioPlayer() {
        audio.ontimeupdate = () => {
            const pct = (audio.currentTime / audio.duration) * 100;
            document.getElementById('player-progress').style.width = `${pct}%`;
        };
        audio.onended = () => { closeAudio(); };
    }
    function seekAudio(e) {
        const container = e.currentTarget;
        const width = container.clientWidth;
        const clickPosition = e.offsetX;
        if (audio.duration) {
            const pct = clickPosition / width;
            audio.currentTime = pct * audio.duration;
        }
    }
    async function fetchQuran() {
        try {
            const res = await fetch('https://api.alquran.cloud/v1/surah');
            const data = await res.json();
            document.getElementById('surah-list').innerHTML = data.data.slice(0, 114).map(s => `
                <div onclick="playSurah(${s.number}, '${s.name}')" class="bg-white p-4 rounded-3xl shadow-sm border border-emerald-100 flex items-center gap-4 active:scale-95 cursor-pointer">
                    <div class="w-10 h-10 bg-emerald-50 text-emerald-700 rounded-xl flex items-center justify-center font-black">${s.number}</div>
                    <div class="flex-1"><h4 class="font-bold text-slate-800">${s.name}</h4><p class="text-[10px] text-slate-400 font-bold uppercase">${s.englishName}</p></div>
                    <div class="text-emerald-600"><i class="fas fa-play-circle text-2xl"></i></div>
                </div>
            `).join('');
        } catch (e) {}
    }
    function playSurah(n, name) {
        audio.src = `https://cdn.islamic.network/quran/audio-surah/128/ar.alafasy/${n}.mp3`;
        audio.play();
        document.getElementById('playing-surah-name').innerText = `প্লে হচ্ছে: ${name}`;
        document.getElementById('quran-player-bar').classList.remove('hidden');
        document.getElementById('play-pause-icon').innerText = '⏸';
    }
    function toggleAudio() { 
        if (audio.paused) { audio.play(); document.getElementById('play-pause-icon').innerText = '⏸'; }
        else { audio.pause(); document.getElementById('play-pause-icon').innerText = '▶'; }
    }
    function closeAudio() { audio.pause(); document.getElementById('quran-player-bar').classList.add('hidden'); }
    function renderDuas() {
        document.getElementById('dua-list').innerHTML = DUAS.map(d => `
            <div class="bg-white p-6 rounded-[2rem] border border-emerald-100 shadow-sm space-y-4">
                <h4 class="font-black text-emerald-900 text-lg flex items-center gap-2"><span class="text-amber-500">✦</span> ${d.title}</h4>
                <p class="text-2xl text-right font-arabic text-emerald-800 leading-relaxed">${d.arabic}</p>
                <div class="p-4 bg-emerald-50 rounded-2xl"><p class="text-[9px] font-black text-emerald-600 uppercase mb-1">উচ্চারণ</p><p class="text-[13px] text-slate-700 font-medium">${d.pronunciation}</p></div>
                <div class="p-4 bg-amber-50 rounded-2xl"><p class="text-[9px] font-black text-amber-600 uppercase mb-1">অনুবাদ</p><p class="text-[13px] text-emerald-950 font-bold">${d.meaning}</p></div>
            </div>
        `).join('');
    }
    function renderNames() {
        document.getElementById('names-grid').innerHTML = ALLAH_NAMES.map(n => `
            <div class="bg-white p-5 rounded-[2rem] border border-emerald-100 shadow-sm flex flex-col items-center text-center group">
                <div class="w-12 h-12 bg-emerald-50 rounded-full flex items-center justify-center mb-3"><span class="text-xl font-arabic text-emerald-700">${n.ar}</span></div>
                <h4 class="font-black text-slate-800 text-sm">${n.bn}</h4>
                <p class="text-[9px] text-slate-400 font-bold uppercase">${n.meaning}</p>
            </div>
        `).join('');
    }
    function switchTab(t) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.islamic-nav-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('islam-' + t).classList.add('active');
        document.querySelector(`.islamic-nav-btn[data-tab="${t}"]`).classList.add('active');
    }
</script>
</body>
</html>
